// For altering permissions of a user outside the predefined system roles
model UserPermission {
  id String @id @default(cuid(2))

  user   User   @relation(fields: [userId], references: [id])
  userId String @map("user_id")

  permission   Permission @relation(fields: [permissionId], references: [id])
  permissionId String     @map("permission_id")

  resourceType ResourceType @map("resource_type")
  resourceId   String?      @map("resource_id")
  // override Permission.inverted
  inverted     Boolean      @default(false)

  grantedBy   User      @relation("PermissionGranter", fields: [grantedById], references: [id])
  grantedById String    @map("granted_by_id")
  expiresAt   DateTime? @map("expires_at") @db.Timestamptz(3)

  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamptz(3)

  @@unique([userId, permissionId, resourceType, resourceId])
  @@index([permissionId])
  @@map("user_permissions")
}
